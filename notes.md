TO DO

1. strip out bad code
2. add in good code from template
3. revise